<html itemscope itemtype="http://schema.org/Product" prefix="og: http://ogp.me/ns#" xmlns="http://www.w3.org/1999/html">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <script>
        window.indexLoadedTime = window.performance.now();
        console.log("(TIME) index.html loaded:\t", indexLoadedTime);
        // XXX the code below listeners for errors and displays an error message
        // in the document body when any of the required files fails to load.
        // The intention is to prevent from displaying broken page.
        var criticalFiles = [
            "config.js",
            "utils.js",
            "do_external_connect.js",
            "interface_config.js",
            "logging_config.js",
            "lib-jitsi-meet.min.js",
            "app.bundle.min.js",
            "all.css",
            "strophe.ofmeet.js" // Load OFMeet-specific plugins for Strophe. BAO / GDK
        ];
        var loadErrHandler = function(e) {
            var target = e.target;
            // Error on <script> and <link>(CSS)
            // <script> will have .src and <link> .href
            var fileRef = (target.src ? target.src : target.href);
            if (("SCRIPT" === target.tagName || "LINK" === target.tagName)
                && criticalFiles.some(
                    function(file) { return fileRef.indexOf(file) !== -1 })) {
                window.onload = function() {
                    // The whole complex part below implements page reloads with
                    // "exponential backoff". The retry attempt is passes as
                    // "rCounter" query parameter
                    var href = window.location.href;

                    var retryMatch = href.match(/.+(\?|&)rCounter=(\d+)/);
                    var retryCountStr = retryMatch ? retryMatch[2] : "0";
                    var retryCount = Number.parseInt(retryCountStr);

                    if (retryMatch == null) {
                        var separator = href.indexOf("?") === -1 ? "?" : "&";
                        var hashIdx = href.indexOf("#");

                        if (hashIdx === -1) {
                            href += separator + "rCounter=1";
                        } else {
                            var hashPart = href.substr(hashIdx);

                            href = href.substr(0, hashIdx)
                                + separator + "rCounter=1" + hashPart;
                        }
                    } else {
                        var separator = retryMatch[1];

                        href = href.replace(
                            /(\?|&)rCounter=(\d+)/,
                            separator + "rCounter=" + (retryCount + 1));
                    }

                    var delay = Math.pow(2, retryCount) * 2000;
                    if (isNaN(delay) || delay < 2000 || delay > 60000)
                        delay = 10000;

                    var showMoreText = "show more";
                    var showLessText = "show less";

                    document.body.innerHTML
                        = "<div style='"
                        + "position: absolute;top: 50%;left: 50%;"
                        + "text-align: center;"
                        + "font-size: medium;"
                        + "font-weight: 400;"
                        + "transform: translate(-50%, -50%)'>"
                        + "Uh oh! We couldn't fully download everything we needed :(" // jshint ignore:line
                        + "<br/> "
                        + "We will try again shortly. In the mean time, check for problems with your Internet connection!" // jshint ignore:line
                        + "<br/><br/> "
                        + "<div id='moreInfo' style='"
                        + "display: none;'>" + "Missing " + fileRef
                        + "<br/><br/></div>"
                        + "<a id='showMore' style='"
                        + "text-decoration: underline;"
                        + "font-size:small;"
                        + "cursor: pointer'>" + showMoreText + "</a>"
                        + "&nbsp;&nbsp;&nbsp;"
                        + "<a href='" + href + "' style='"
                        + "text-decoration: underline;"
                        + "font-size:small;"
                        + "'>reload now</a>"
                        + "</div>";

                    var showMoreElem = document.getElementById("showMore");
                    showMoreElem.addEventListener('click', function () {
                            var moreInfoElem
                                    = document.getElementById("moreInfo");

                            if (showMoreElem.innerHTML === showMoreText) {
                                moreInfoElem.setAttribute(
                                    "style",
                                    "display: block;"
                                    + "color:#FF991F;"
                                    + "font-size:small;"
                                    + "user-select:text;");
                                showMoreElem.innerHTML = showLessText;
                            }
                            else {
                                moreInfoElem.setAttribute(
                                    "style", "display: none;");
                                showMoreElem.innerHTML = showMoreText;
                            }
                        });

                    window.setTimeout(
                        function () { window.location.replace(href); }, delay);
                };
                window.removeEventListener(
                    'error', loadErrHandler, true /* capture phase */);
            }
        };
        window.addEventListener(
            'error', loadErrHandler, true /* capture phase type of listener */);
    </script>
    <script src="config.js"></script>
    <script src="utils.js?v=1"></script>
    <script src="connection_optimization/do_external_connect.js?v=1"></script>
    <script>var interfaceConfig = { // eslint-disable-line no-unused-vars
        CANVAS_EXTRA: 104,
        CANVAS_RADIUS: 0,
        SHADOW_COLOR: '#ffffff',
        // TO FIX: this needs to be handled from SASS variables. There are some
        // methods allowing to use variables both in css and js.
        DEFAULT_BACKGROUND: '#474747',
        INITIAL_TOOLBAR_TIMEOUT: 20000,
        TOOLBAR_TIMEOUT: 4000,
        DEFAULT_REMOTE_DISPLAY_NAME: "Fellow Jitster",
        DEFAULT_LOCAL_DISPLAY_NAME: "me",
        SHOW_JITSI_WATERMARK: true,
        JITSI_WATERMARK_LINK: "https://jitsi.org",
        SHOW_BRAND_WATERMARK: false,
        BRAND_WATERMARK_LINK: "",
        SHOW_POWERED_BY: false,
        GENERATE_ROOMNAMES_ON_WELCOME_PAGE: true,
        APP_NAME: "Jitsi Meet",
        LANG_DETECTION: false,    // Allow i18n to detect the system language
        INVITATION_POWERED_BY: true,
        /**
         * If we should show authentication block in profile
         */
        AUTHENTICATION_ENABLE: true,
        /**
         * The index of the splitter button in the main toolbar. The splitter
         * button is a button in the toolbar that will be applied a special styling
         * visually dividing the toolbar buttons.
         */
        //MAIN_TOOLBAR_SPLITTER_INDEX: -1,
        /**
         * the toolbar buttons line is intentionally left in one line, to be able
         * to easily override values or remove them using regex
         */
        TOOLBAR_BUTTONS: [
            //main toolbar
            'microphone', 'camera', 'desktop', 'invite', 'fullscreen', 'hangup',
            //extended toolbar
            'profile', 'contacts', 'chat', 'recording', 'etherpad', 'sharedvideo', 'sip', 'dialpad', 'settings', 'raisehand', 'filmstrip'], // jshint ignore:line
        /**
         * Main Toolbar Buttons
         * All of them should be in TOOLBAR_BUTTONS
         */
        MAIN_TOOLBAR_BUTTONS: ['microphone', 'camera', 'desktop', 'invite', 'fullscreen', 'hangup'], // jshint ignore:line
        SETTINGS_SECTIONS: ['language', 'devices', 'moderator'],
        // Determines how the video would fit the screen. 'both' would fit the whole
        // screen, 'height' would fit the original video height to the height of the
        // screen, 'width' would fit the original video width to the width of the
        // screen respecting ratio.
        VIDEO_LAYOUT_FIT: 'both',
        SHOW_CONTACTLIST_AVATARS: false,
        /**
         * Whether to only show the filmstrip (and hide the toolbar).
         */
        filmStripOnly: false,
        RANDOM_AVATAR_URL_PREFIX: false,
        RANDOM_AVATAR_URL_SUFFIX: false,
        FILM_STRIP_MAX_HEIGHT: 120,
        // Enables feedback star animation.
        ENABLE_FEEDBACK_ANIMATION: false,
        DISABLE_FOCUS_INDICATOR: false,
        DISABLE_DOMINANT_SPEAKER_INDICATOR: false,
        // disables the ringing sound when the RingOverlay is shown.
        DISABLE_RINGING: false,
        AUDIO_LEVEL_PRIMARY_COLOR: "rgba(255,255,255,0.4)",
        AUDIO_LEVEL_SECONDARY_COLOR: "rgba(255,255,255,0.2)",
        POLICY_LOGO: null,
        LOCAL_THUMBNAIL_RATIO: 16/9, //16:9
        REMOTE_THUMBNAIL_RATIO: 1 //1:1
    };
    </script>
    <script>// Logging configuration
    var loggingConfig = { // eslint-disable-line no-unused-vars
        //default log level for the app and lib-jitsi-meet
        defaultLogLevel: 'trace',
        // Option to disable LogCollector (which stores the logs on CallStats)
        //disableLogCollector: true,
        // Logging level adjustments for verbose modules:
        'modules/xmpp/strophe.util.js': 'log'
    };</script>
    <script src="libs/lib-jitsi-meet.min.js?v=139"></script>
    <script src="libs/app.bundle.min.js?v=139"></script>
    <!-- Load OFMeet-specific plugins for Strophe. BAO / GDK -->
    <script src="../libs/strophe.ofmeet.js?v=2"></script>
    <title>Jitsi Meet</title>
    <meta property="og:title" content="Jitsi Meet"/>
    <meta property="og:image" content="images/jitsilogo.png?v=1"/>
    <meta property="og:description" content="Join a WebRTC video conference powered by the Jitsi Videobridge"/>
    <meta description="Join a WebRTC video conference powered by the Jitsi Videobridge"/>
    <meta itemprop="name" content="Jitsi Meet"/>
    <meta itemprop="description" content="Join a WebRTC video conference powered by the Jitsi Videobridge"/>
    <meta itemprop="image" content="images/jitsilogo.png?v=1"/>
    <link rel="icon" type="image/png" href="images/favicon.ico?v=1"/>
    <link rel="stylesheet" href="css/all.css">
  </head>
  <body>
    <div id="react"></div>
    <div id="keyboard-shortcuts" class="keyboard-shortcuts" style="display:none;">
        <div class="content">
            <ul id="keyboard-shortcuts-list" class="shortcuts-list">
            </ul>
        </div>
    </div>
  </body>
</html>
